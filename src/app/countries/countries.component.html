<div class="container" *ngIf="countries">
  <div class="row mt-3 justify-content-center text-center">
    <h1 [ngClass]="{'region-name': region,'filter-name': !region}">{{filter | languageName | uppercase}}</h1>
    <h2 class="col-12 mt-0" *ngIf="filter.length == 2">Countries with language {{filter| languageName}}</h2>
    <h2 class="col-12 mt-0" *ngIf="filter.length == 3">Countries with currency - {{filter}}</h2>
  </div>
  <img *ngIf="region" class="img-fluid d-block mx-auto" src="../../assets/{{region}}-header.png" [ngClass]="{'mt-3': region == 'americas' || region == 'oceania'}"
    style="height:50vh">

  <div class="row justify-content-center my-5">
    <div class="col text-center">
      <div class="row">
        <div class="col-12 display-4">{{countries.length}}</div>
        <small class="col-12">Number of countries</small>
      </div>
    </div>
    <div class="col text-center">
      <div class="row">
        <div class="col-12 display-4">{{highestPopulationCountry.population | numberToMB }}</div>
        <div class="col-12">{{highestPopulationCountry.name}}</div>
        <small class="col-12">Highest population country</small>
      </div>
    </div>
    <div class="col text-center">
      <div class="row">
        <div class="col-12 display-4">{{population | numberToMB}}</div>
        <small class="col-12">Overall population</small>
      </div>
    </div>
    <div class="col text-center">
      <div class="row">
        <div class="col-12 display-4">{{lowestPopulationCountry.population | numberToMB }}</div>
        <div class="col-12">{{lowestPopulationCountry.name}}</div>
        <small class="col-12">Lowest population country</small>
      </div>
    </div>
    <div class="col text-center" *ngIf="region">
      <div class="row">
        <div class="col-12 display-4">{{languages.size}}</div>
        <small class="col-12">Languages spoken</small>
      </div>
    </div>
  </div>

  <div class="row my-5" *ngIf="region">
    <div class="col-12">
      <h2>Languages</h2>
    </div>
    <div class="col-auto lead hover" *ngFor="let lang of languages" (click)="languageModel = lang">
      {{lang}}
    </div>
  </div>

  <div class="row justify-content-center align-items-center">
    <div class="col-12">
      <h2>Countries</h2>
    </div>
    <div class="col-12">
      <div class="row justify-content-end px-5">
        <div class="col-3 sort" [ngClass]="{active: languageModel}" *ngIf="region">
          <small class="text-uppercase">Filter by language</small>
          <br>
          <select [(ngModel)]="languageModel">
            <option *ngFor="let language of languages" value="{{language}}">{{language}}</option>
          </select>
        </div>
        <div class="col-3 sort" [ngClass]="{active: sortField}">
          <small class="text-uppercase">Sort by</small>
          <br>
          <select [(ngModel)]="sortField" (change)="sortBy(sortField)">
            <option value="name">Name A-Z</option>
            <option value="name1">Name Z-A</option>
            <option value="population">Population Low to high</option>
            <option value="population1">Popuation High to low</option>
          </select>
        </div>
        <div class="col-3 search-input" [ngClass]="{active: searchInput}">
          <small class="text-uppercase">Search</small>
          <br>
          <input type="text" [(ngModel)]="searchInput" placeholder="Search country">
        </div>
        <div class="col-auto align-self-center">
          <button class="reset-btn" (click)="sortBy('name');searchInput=sortField=languageModel=undefined">Reset filters</button>
        </div>
        <div class="col-12" *ngIf="selectedCurrency">
          Showing countries with currency -
          <b>{{selectedCurrency}}</b>
        </div>
      </div>
    </div>
    <div class="col-auto" *ngFor="let country of countries | search: searchInput | search: languageModel:'language' | search: selectedCurrency:'currency'">
      <div class="card my-3" style="width: 18rem;">
        <img class="card-img-top" src="{{country.flag}}" alt="Card image cap" style="height: 22vh;">
        <div class="card-body">
          <h5 class="card-title mb-1">{{country.name}} ({{country.alpha3Code}})</h5>
          <p class="card-text">
            <small>
              <b>Capital:</b> {{country.capital}}
              <br>
              <b>Population:</b> {{country.population}}
              <br>
              <b>Currency:</b>
              <span class="hover" *ngFor="let currency of country.currencies" [routerLink]="['/countries',currency.code]"> {{currency.name}} </span>
              <br>
              <b>Languages:</b>
              <span class="hover" *ngFor="let language of country.languages" [routerLink]="['/countries',language.iso639_1]"> {{language.name}} </span>
              <br>
            </small>
          </p>
          <span [routerLink]="['/country',country.alpha3Code]">View details</span>
        </div>
      </div>
    </div>
  </div>
</div>